---
interface Props {
  title: string;
  url: string;
  description?: string;
  type?: "documentation" | "tutorial" | "tool" | "reference" | "video" | "article" | "book" | "course";
  external?: boolean;
}

const { 
  title, 
  url, 
  description,
  type = "reference",
  external = true
} = Astro.props;

// Icon mapping for different resource types
const typeIcons = {
  documentation: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
    <polyline points="14,2 14,8 20,8"></polyline>
    <line x1="16" y1="13" x2="8" y2="13"></line>
    <line x1="16" y1="17" x2="8" y2="17"></line>
    <polyline points="10,9 9,9 8,9"></polyline>
  </svg>`,
  
  tutorial: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="m9 9 3 3m0 0 3-3m-3 3V4m0 14.5a9.5 9.5 0 1 1 0-19 9.5 9.5 0 0 1 0 19z"></path>
  </svg>`,
  
  tool: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
  </svg>`,
  
  reference: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
  </svg>`,
  
  video: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <polygon points="23 7 16 12 23 17 23 7"></polygon>
    <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
  </svg>`,
  
  article: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"></path>
    <path d="M9 9h6"></path>
    <path d="M9 13h6"></path>
    <path d="M9 17h3"></path>
  </svg>`,
  
  book: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
  </svg>`,
  
  course: `<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M22 10v6M2 10l10-5 10 5-10 5z"></path>
    <path d="M6 12v5c3 3 9 3 12 0v-5"></path>
  </svg>`
};

const typeLabels = {
  documentation: "Documentation",
  tutorial: "Tutorial",
  tool: "Tool",
  reference: "Reference",
  video: "Video",
  article: "Article",
  book: "Book",
  course: "Course"
};
---

<div class="cheatsheet-resource" data-type={type}>
  <a 
    href={url} 
    class="cheatsheet-resource__link"
    target={external ? "_blank" : "_self"}
    rel={external ? "noopener noreferrer" : ""}
  >
    <div class="cheatsheet-resource__icon" set:html={typeIcons[type]} />
    
    <div class="cheatsheet-resource__content">
      <div class="cheatsheet-resource__header">
        <h4 class="cheatsheet-resource__title">{title}</h4>
        <div class="cheatsheet-resource__meta">
          <span class="cheatsheet-resource__type">{typeLabels[type]}</span>
          {external && (
            <svg class="cheatsheet-resource__external-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
              <polyline points="15,3 21,3 21,9"></polyline>
              <line x1="10" y1="14" x2="21" y2="3"></line>
            </svg>
          )}
        </div>
      </div>
      {description && (
        <p class="cheatsheet-resource__description">{description}</p>
      )}
    </div>
  </a>
</div>

<style>
  .cheatsheet-resource {
    border-bottom: 1px solid var(--sl-color-gray-6);
    transition: all 0.2s ease;
  }

  .cheatsheet-resource:last-child {
    border-bottom: none;
  }

  .cheatsheet-resource__link {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1rem 2rem;
    text-decoration: none;
    color: inherit;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
  }

  .cheatsheet-resource__link::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 0;
    background: linear-gradient(90deg, var(--sl-color-accent), transparent);
    transition: width 0.3s ease;
  }

  .cheatsheet-resource__link:hover {
    background: var(--sl-color-gray-6);
    transform: translateX(4px);
  }

  .cheatsheet-resource__link:hover::before {
    width: 4px;
  }

  .cheatsheet-resource__link:focus {
    outline: 2px solid var(--sl-color-accent);
    outline-offset: -2px;
  }

  .cheatsheet-resource__icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    background: var(--sl-color-gray-6);
    border-radius: 8px;
    flex-shrink: 0;
    margin-top: 0.125rem;
    transition: all 0.2s ease;
  }

  .cheatsheet-resource__icon svg {
    color: var(--sl-color-accent);
  }

  .cheatsheet-resource__link:hover .cheatsheet-resource__icon {
    background: var(--sl-color-accent);
    transform: scale(1.05);
  }

  .cheatsheet-resource__link:hover .cheatsheet-resource__icon svg {
    color: var(--sl-color-white);
  }

  .cheatsheet-resource__content {
    flex: 1;
    min-width: 0;
  }

  .cheatsheet-resource__header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
    margin-bottom: 0.25rem;
  }

  .cheatsheet-resource__title {
    margin: 0;
    font-size: 1rem;
    font-weight: 600;
    color: var(--sl-color-white);
    line-height: 1.3;
    flex: 1;
  }

  .cheatsheet-resource__meta {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-shrink: 0;
  }

  .cheatsheet-resource__type {
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--sl-color-gray-2);
    background: var(--sl-color-gray-6);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    text-transform: uppercase;
    letter-spacing: 0.025em;
  }

  .cheatsheet-resource__external-icon {
    color: var(--sl-color-gray-3);
    flex-shrink: 0;
  }

  .cheatsheet-resource__description {
    margin: 0;
    font-size: 0.875rem;
    color: var(--sl-color-gray-2);
    line-height: 1.5;
  }

  /* Type-specific styling */
  .cheatsheet-resource[data-type="documentation"] .cheatsheet-resource__type {
    color: var(--sl-color-blue);
    background: color-mix(in srgb, var(--sl-color-blue) 15%, transparent);
  }

  .cheatsheet-resource[data-type="tutorial"] .cheatsheet-resource__type {
    color: var(--sl-color-green);
    background: color-mix(in srgb, var(--sl-color-green) 15%, transparent);
  }

  .cheatsheet-resource[data-type="tool"] .cheatsheet-resource__type {
    color: var(--sl-color-purple);
    background: color-mix(in srgb, var(--sl-color-purple) 15%, transparent);
  }

  .cheatsheet-resource[data-type="video"] .cheatsheet-resource__type {
    color: var(--sl-color-red);
    background: color-mix(in srgb, var(--sl-color-red) 15%, transparent);
  }

  .cheatsheet-resource[data-type="course"] .cheatsheet-resource__type {
    color: var(--sl-color-orange);
    background: color-mix(in srgb, var(--sl-color-orange) 15%, transparent);
  }

  /* Print Styles */
  @media print {
    .cheatsheet-resource {
      break-inside: avoid;
      border-bottom: 1px solid #ccc !important;
    }

    .cheatsheet-resource__link {
      background: transparent !important;
      transform: none !important;
    }

    .cheatsheet-resource__link::before {
      display: none !important;
    }

    .cheatsheet-resource__title {
      color: #000 !important;
    }

    .cheatsheet-resource__description {
      color: #333 !important;
    }

    .cheatsheet-resource__type {
      background: #f0f0f0 !important;
      color: #333 !important;
    }

    .cheatsheet-resource__icon {
      background: #f5f5f5 !important;
    }

    .cheatsheet-resource__icon svg {
      color: #333 !important;
    }

    /* Show URL for external links */
    .cheatsheet-resource__link[target="_blank"]::after {
      content: " (" attr(href) ")";
      font-size: 0.75rem;
      color: #666;
      font-weight: normal;
    }
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .cheatsheet-resource__link {
      padding: 0.75rem 1.5rem;
    }

    .cheatsheet-resource__header {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }

    .cheatsheet-resource__meta {
      align-self: flex-end;
    }
  }

  @media (max-width: 480px) {
    .cheatsheet-resource__link {
      padding: 0.75rem 1rem;
      gap: 0.75rem;
    }

    .cheatsheet-resource__icon {
      width: 2rem;
      height: 2rem;
    }

    .cheatsheet-resource__icon svg {
      width: 16px;
      height: 16px;
    }

    .cheatsheet-resource__title {
      font-size: 0.9rem;
    }

    .cheatsheet-resource__description {
      font-size: 0.8rem;
    }

    .cheatsheet-resource__type {
      font-size: 0.7rem;
    }
  }

  /* Support for browsers without color-mix */
  @supports not (color: color-mix(in srgb, red, blue)) {
    .cheatsheet-resource[data-type="documentation"] .cheatsheet-resource__type {
      background: rgba(59, 130, 246, 0.15);
    }

    .cheatsheet-resource[data-type="tutorial"] .cheatsheet-resource__type {
      background: rgba(34, 197, 94, 0.15);
    }

    .cheatsheet-resource[data-type="tool"] .cheatsheet-resource__type {
      background: rgba(168, 85, 247, 0.15);
    }

    .cheatsheet-resource[data-type="video"] .cheatsheet-resource__type {
      background: rgba(239, 68, 68, 0.15);
    }

    .cheatsheet-resource[data-type="course"] .cheatsheet-resource__type {
      background: rgba(249, 115, 22, 0.15);
    }
  }

  /* High Contrast Mode Support */
  @media (prefers-contrast: high) {
    .cheatsheet-resource {
      border-bottom-width: 2px;
    }

    .cheatsheet-resource__link:focus {
      outline-width: 3px;
    }

    .cheatsheet-resource__type {
      border: 1px solid currentColor;
    }
  }

  /* Reduced Motion Support */
  @media (prefers-reduced-motion: reduce) {
    .cheatsheet-resource,
    .cheatsheet-resource__link,
    .cheatsheet-resource__link::before,
    .cheatsheet-resource__icon {
      transition: none;
    }

    .cheatsheet-resource__link:hover {
      transform: none;
    }

    .cheatsheet-resource__link:hover .cheatsheet-resource__icon {
      transform: none;
    }
  }
</style>