---
interface Props {
  /**
   * Maximum width of the container
   */
  maxWidth?: string;
  /**
   * Padding around the container content
   */
  padding?: string;
  /**
   * Enable container queries for child components
   */
  enableQueries?: boolean;
  /**
   * Theme variant
   */
  theme?: 'auto' | 'light' | 'dark';
  /**
   * Background style
   */
  background?: 'none' | 'subtle' | 'elevated';
  /**
   * Additional CSS classes
   */
  class?: string;
  /**
   * Container size hint for optimal layout
   */
  size?: 'sm' | 'md' | 'lg' | 'xl' | 'full';
  /**
   * Enable responsive behavior
   */
  responsive?: boolean;
}

const {
  maxWidth,
  padding = '1.5rem',
  enableQueries = true,
  theme = 'auto',
  background = 'none',
  class: className = '',
  size = 'full',
  responsive = true,
} = Astro.props;

// Size-based max-width presets
const sizePresets = {
  sm: '640px',
  md: '768px',
  lg: '1024px',
  xl: '1280px',
  full: '100%',
};

const containerMaxWidth = maxWidth || sizePresets[size];
---

<div 
  class={`bento-container ${className}`}
  data-theme={theme}
  data-background={background}
  data-size={size}
  data-responsive={responsive}
  data-queries={enableQueries}
  style={{
    '--container-max-width': containerMaxWidth,
    '--container-padding': padding,
  }}
>
  <slot />
</div>

<style>
  .bento-container {
    width: 100%;
    max-width: var(--container-max-width);
    margin: 0 auto;
    padding: var(--container-padding);
    position: relative;
  }

  /* Enable container queries when requested */
  .bento-container[data-queries="true"] {
    container-type: inline-size;
    container-name: bento-container;
  }

  /* Background variants */
  .bento-container[data-background="subtle"] {
    background-color: var(--sl-color-bg-sidebar, #f8fafc);
    border-radius: 1rem;
  }

  .bento-container[data-background="elevated"] {
    background-color: var(--sl-color-bg-card, #ffffff);
    border: 1px solid var(--sl-color-gray-5, #e5e7eb);
    border-radius: 1rem;
    box-shadow: 
      0 4px 6px -1px rgba(0, 0, 0, 0.1),
      0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }

  /* Theme variants */
  .bento-container[data-theme="light"] {
    color-scheme: light;
    --sl-color-bg-card: #ffffff;
    --sl-color-bg-sidebar: #f8fafc;
    --sl-color-text: #1e293b;
  }

  .bento-container[data-theme="dark"] {
    color-scheme: dark;
    --sl-color-bg-card: #1e293b;
    --sl-color-bg-sidebar: #0f172a;
    --sl-color-text: #f1f5f9;
  }

  /* Dark mode styles for elevated backgrounds */
  :global(.sl-theme-dark) .bento-container[data-background="subtle"] {
    background-color: var(--sl-color-bg-sidebar, #0f172a);
  }

  :global(.sl-theme-dark) .bento-container[data-background="elevated"] {
    background-color: var(--sl-color-bg-card, #1e293b);
    border-color: var(--sl-color-gray-6, #4b5563);
  }

  /* Responsive padding adjustments */
  .bento-container[data-responsive="true"] {
    padding: clamp(1rem, 4vw, var(--container-padding));
  }

  /* Container query adjustments */
  @container (max-width: 600px) {
    .bento-container[data-responsive="true"] {
      padding: 1rem;
    }
  }

  @container (min-width: 1200px) {
    .bento-container[data-responsive="true"] {
      padding: calc(var(--container-padding) * 1.2);
    }
  }

  /* Size-specific adjustments */
  .bento-container[data-size="sm"] {
    max-width: min(var(--container-max-width), 90vw);
  }

  .bento-container[data-size="md"] {
    max-width: min(var(--container-max-width), 85vw);
  }

  .bento-container[data-size="lg"] {
    max-width: min(var(--container-max-width), 90vw);
  }

  .bento-container[data-size="xl"] {
    max-width: min(var(--container-max-width), 95vw);
  }

  /* Focus management for accessibility */
  .bento-container:focus-within {
    outline: none;
  }

  /* Print styles */
  @media print {
    .bento-container {
      max-width: none;
      padding: 0;
      background: white !important;
      border: none !important;
      box-shadow: none !important;
    }
  }

  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    .bento-container * {
      transition-duration: 0.01ms !important;
      animation-duration: 0.01ms !important;
    }
  }
</style>